# Поиск ячеек с одинаковым ВГХ, и разным весом
# Вывод количества ячеек, вгх вес.
select count(plnam), lttnam, PLGEWMAX from (
select plnam, LTT.LTTNAM, PL.PLGEWMAX from PETR_S2_PDBA.LTT_T ltt
join PETR_S2_PDBA.pl_t Pl on pl.pllng = ltt.LTTAULNG
and pl.plbre = ltt.LTTAUBRE
AND pl.plhoe = ltt.LTTAUHOE)
group by lttnam, PLGEWMAX
order by LTTNAM

# Вывод ячеек по типу
select  plnam, lttnam, PLGEWMAX from (
select plnam, LTT.LTTNAM, PL.PLGEWMAX from PETR_S2_PDBA.LTT_T ltt
join PETR_S2_PDBA.pl_t Pl on pl.pllng = ltt.LTTAULNG
and pl.plbre = ltt.LTTAUBRE
AND pl.plhoe = ltt.LTTAUHOE
and lttnam = '1200*800*1200')
order by plgewmax


# Вывод артикулов их вгх а так же вместимость на паллете и вгх паллеты
select art_t.artnr, art_t.artelmsel, art_t.artlng, art_t.artbre,arthoe, art_t.artabmeh, artltt_t.artlttmgmax, artltt_t.artlttlng, artltt_t.artlttbre, artltt_t.artltthoe from PETR_S3_PDBA.art_t
left join PETR_S3_PDBA.artltt_t on art_t.artid = artltt_t.artid
where 
artltt_t.lttnam = 'PF'

# вывод артикулов где не проставлен признак "тип те для перекладки" 
select distinct artnr from PETR_S3_PDBA.art_t
left join PETR_S3_PDBA.artltt_t on art_t.artid = artltt_t.artid
where artltt_t.lttnam = 'PF' and artlttknzdefltkom2 = 0

# Поиск артикулов, где не соответствует признак склада к месту хранения 
select artid, artelmsel, substr(plnam, 1,3) from (
select art_t.artid, art_t.artelmsel, bst_t.tenam, te_t.plnam from PETR_S3_PDBA.art_t 
left join PETR_S3_PDBA.bst_t on art_t.artid = bst_t.artid
left join PETR_S3_PDBA.te_T on bst_t.tenam = te_t.tenam
where art_t.artelmsel IN ('01A','02B','03C','04D','04T', '03F', '03N')
and bst_t.artid != 'EMPTY'
and te_t.plnam not like 'AUS%'
and te_t.plnam not like 'VRS%'
and te_t.plnam not like 'SRP%'
and te_t.plnam not like 'INP%'
and te_t.plnam not like 'PP%'
and te_t.plnam not like 'TOR%'
and te_t.plnam not like 'UWE%'
)
where artelmsel != substr(plnam, 1,3)
