select distinct substr(bst.artid, 9,11), art.artbez, art.ArtElmSel2
from PETR_S3_PDBA.bst_t bst 
left join PETR_S3_PDBA.art_t art on bst.artid = art.artid
left join PETR_S3_PDBA.te_t te on te.tenam = bst.tenam
left join PETR_S3_PDBA.pl_t pl on te.plnam = pl.plnam
where 
bst.artid != 'EMPTY' 
and art.artklaabc = 1
and pl.plknzezlres = 0
and pl.plnam not like 'AUS%'
and pl.plnam not like 'TOR%'
and pl.plnam not like 'VRS%'
and pl.plnam not like 'FZG%'
and pl.plnam not like 'XXX%'
and pl.plnam not like 'SRP%'
and pl.benam IN (:WH)
and art.ArtElmSel2 IN (:ELM)

minus

select distinct substr(bst.artid, 9,11), art.artbez,art.ArtElmSel2
from PETR_S3_PDBA.bst_t bst 
left join PETR_S3_PDBA.art_t art on bst.artid = art.artid
left join PETR_S3_PDBA.te_t te on te.tenam = bst.tenam
left join PETR_S3_PDBA.pl_t pl on te.plnam = pl.plnam
where 
bst.artid != 'EMPTY' 
and art.artklaabc = 1
and pl.plknzezlres = 0
and pl.plnam not like 'AUS%'
and pl.plnam not like 'TOR%'
and pl.plnam not like 'VRS%'
and pl.plnam not like 'FZG%'
and pl.plnam not like 'XXX%'
and pl.plnam not like 'SRP%'
and pl.elbnam like '%KOM'
and pl.benam IN (:WH)
and art.ArtElmSel2 IN (:ELM)


-- :WH parametr
select * from (
select distinct regexp_substr(benam, ('^\d+\w')) as WH from PETR_S3_PDBA.pl_t)
order by WH

-- :ELM parametr
select * from (
select distinct ArtElmSel2 from PETR_S3_PDBA.art_t)
order by ArtElmSel2
